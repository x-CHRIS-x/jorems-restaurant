{% extends "navbar.html" %}

{% block title %}Checkout Successful{% endblock %}

{% block additional_styles %}
    <style>
        .content-wrapper {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }
        
        .success-container { 
            background: #fff; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
            margin: 20px auto;
            max-width: 800px;
        }
        h1 { color: #27ae60; }
        table { 
            margin: 20px auto; 
            border-collapse: collapse; 
            width: 100%; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
        }
        th, td { 
            border: 1px solid #ccc; 
            padding: 10px; 
            text-align: center; 
            vertical-align: middle; 
        }
        th { background: #82e0aa; }
        .total-row td { 
            font-weight: bold; 
            font-size: 1.1em; 
        }
        a { 
            display: inline-block; 
            margin-top: 20px; 
            text-decoration: none; 
            font-weight: bold; 
        }
        td img {
            width: 120px;
            height: 80px;
            object-fit: cover;
            border-radius: 5px;
        }
        .qr { margin-top: 25px; }
        .qr img {
            width: 200px;
            height: 200px;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 5px;
            background: #fff;
        }
        /* âœ… Download button styling */
        .btn-download {
            display: inline-block;
            margin: 15px;
            padding: 10px 20px;
            background: #2ecc71;
            color: white;
            font-weight: bold;
            border-radius: 6px;
            text-decoration: none;
            transition: 0.3s;
        }
        .btn-download:hover {
            background: #27ae60;
        }
        .btn-back {
            color: #229954;
        }
        .btn-back:hover {
            color: #145a32;
        }
    </style>
{% endblock %}

{% block content %}
<div class="content-wrapper">
    <div class="success-container">
        <h1>Thank You For Your Order, {{ session.username }}!</h1>
        <p>Your order has been placed successfully.</p>

        <h3>Order Summary</h3>
        <table>
            <tr>
                <th>Image</th>
                <th>Item</th>
                <th>Quantity</th>
                <th>Subtotal</th>
            </tr>
            {% for item in order %}
            <tr>
                <td><img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.name }}"></td>
                <td>{{ item.name }}</td>
                <td>{{ item.qty }}</td>
                <td>PHP {{ "%.2f"|format(item.subtotal) }}</td>
            </tr>
            {% endfor %}
            <tr class="total-row">
                <td colspan="3">Total</td>
                <td>PHP {{ "%.2f"|format(total) }}</td>
            </tr>
        </table>

        <!-- âœ… QR Code Section -->
        {% if qr_image %}
        <div class="qr">
            <h3>Scan QR Receipt</h3>
            <img src="{{ qr_image }}" alt="QR Code Receipt">
        </div>
        {% endif %}

        <!-- âœ… Download Receipt Button -->
        <a href="{{ url_for('download_receipt') }}" class="btn-download">ðŸ“¥ Download Receipt (PDF)</a>

        <br>
        {% if session.is_staff %}
                <a href="{{ url_for('staff_menu') }}" class="btn-back" style="padding: 12px 25px; margin: 10px; background: #dc3545; color: white; text-decoration: none; border-radius: 8px; display: inline-block;">â¬… Back to Menu</a>
            {% else %}
                <a href="{{ url_for('index') }}" class="btn-back" style="padding: 12px 25px; margin: 10px; background: #dc3545; color: white; text-decoration: none; border-radius: 8px; display: inline-block;">â¬… Back to Menu</a>
            {% endif %}
    </div>
{% endblock %}